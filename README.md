# Douban Movie Data Analysis & Recommendation System

豆瓣电影数据分析与推荐系统  

## 项目概述

本项目基于豆瓣电影数据集，围绕电影受欢迎程度分析、评分预测及相似性推荐系统三大核心问题展开研究。通过数据清洗、特征工程、机器学习模型（K-means聚类、随机森林分类）及推荐算法（余弦相似度），挖掘电影特征与用户偏好的关联，为电影产业决策提供数据驱动的参考。  

## 数据来源

豆瓣电影数据通过爬取方式获得

## 问题分析

### 一、电影受欢迎程度分析

#### 研究目标

探究电影受欢迎程度的分布规律及关键影响因素，识别“最受欢迎”“受欢迎”“冷门”电影的特征差异。  

#### 建模过程

1. **数据处理与特征工程** 
   1. **数据清洗**：删除无关变量（如电影链接、爬取时间），过滤异常评分（保留0-10分有效数据），提取年份、电影时长等连续特征。  
   2. **多值特征处理**：对电影类型、演员、导演等多值字段，采用词频编码（CountVectorizer）与独热编码，将文本信息转化为高维数值特征矩阵。  

1. **聚类分析**  
   1. **Calinski-Harabasz指数优化聚类数**：通过计算类间离散度与类内紧凑度的比值，自动确定最优聚类数为3类（最受欢迎、受欢迎、冷门），避免主观经验偏差。  
   2. **K-means聚类**：基于高维特征矩阵进行聚类，捕捉电影在评分、评分人数、类型、主创团队等维度的综合差异。  
   3. **TSNE降维可视化**：将高维特征映射到二维空间，通过散点图直观展示三类电影的分布边界，验证聚类效果的显著性。  

#### 结论

- **分布特征**：  
  - 受欢迎电影与冷门电影占比最高（合计超70%），“最受欢迎”电影稀缺（约15%），反映市场竞争激烈，头部效应明显。  
- **核心影响因素**：  
  - **类型偏好**：剧情、喜剧、动画为高频类型，犯罪、爱情类影片次之，体现大众主流观影倾向。  
  - **主创影响力**：知名演员（如刘德华、樱井孝宏）、导演（如杜琪峰、王晶）参与的影片，评分人数显著更高，说明明星效应直接提升电影关注度。  

### 二、电影评分预测

#### 研究目标

将电影评分从连续回归任务转化为三分类问题（低/中/高评分），构建模型预测电影评分等级，为电影质量评估与市场预判提供支持。  

#### 建模过程

1. **数据预处理**  
   1. **分位数分箱**：按评分的25%（Q1）和75%（Q3）分位点，划分为低评分（<6.5）、中评分（6.5-8.5）、高评分（>8.5）三类，同步对评分人数、电影时长进行分箱处理。  
   2. **特征整合**：融合类型、演员、导演等多值特征编码结果，与分箱后的连续变量组合，形成结构化输入数据。  

1. **随机森林****分类模型**  
   1. **模型构建**：采用集成学习框架，通过Bootstrap抽样生成多棵决策树，以投票机制确定分类结果，降低过拟合风险，提升模型鲁棒性。  
   2. **贝叶斯优化**：针对超参数（树的数量、最大深度、最小分裂样本数）进行全局搜索，通过概率模型动态调整搜索方向，较传统网格搜索效率提升30%。  

1. **模型评估**  
   1. **核心指标**：整体准确率61%，高评分类别AUC达0.81（区分能力较强），低/中评分AUC分别为0.37/0.47（区分效果待优化）。  
   2. **混淆矩阵**：中评分电影召回率最高（85%），但精准率仅59%，反映模型对中间区间评分的误判较多；高评分电影精准率66%，但召回率仅33%，说明漏判问题较突出。  

#### 应用价值

为电影制作方提供评分预判工具，辅助优化剧本类型、演员阵容等决策，降低市场风险；同时可用于用户端评分筛选，提升内容匹配效率。  

### 三、基于相似性的推荐系统

#### 研究目标

利用“喜欢这部电影的人也喜欢”关联数据，构建电影推荐系统，解决用户信息过载问题，提升小众电影曝光度与用户体验。  

#### 建模过程

1. **数据预处理**  
   1. **关联数据清洗**：从`connection.txt`提取“源电影-推荐电影”共现对，删除缺失值并随机采样，降低大规模数据计算复杂度。  
   2. **稀疏矩阵构建**：以电影ID为索引，构建共现次数的稀疏矩阵（csr_matrix），有效处理百万级数据的存储与运算。  

1. **推荐算法实现**  
   1. **余弦相似度计算**：衡量电影共现向量的方向相似性，公式为：
      -   $$\text{cosine相似度} = \frac{\boldsymbol{A} \cdot \boldsymbol{B}}{|\boldsymbol{A}||\boldsymbol{B}|}$$
   2. **Top-N推荐**：根据相似度矩阵，为每部电影生成Top-5相似电影列表，排除自身关联，提升推荐多样性。  

1. **系统评估**  
   1. **性能指标**：  
      - 平均精准率0.29（推荐列表中29%为真实相关电影），召回率0.14（仅14%相关电影被推荐）。  
      - 最优电影ID 25780574的精准率达1.00、召回率0.56，表明部分场景下推荐效果优异。  
   2. **可视化分析**：通过相似度热力图展示电影间关联强度，对角线为自身相似度（1.00），非对角线高值区域反映类型、风格或受众高度相似的电影集群。  

#### 优化方向

当前模型依赖单一共现数据，未来可引入用户评分、评论情感分析等多源数据，结合矩阵分解或深度学习模型（如Neural Collaborative Filtering），进一步提升推荐精准度与个性化水平。  